<h2 mat-dialog-title class="text-lg font-bold mb-6">Change Password</h2>

<div mat-dialog-content class="space-y-6">
  <form [formGroup]="changePasswordForm">
    <mat-form-field class="w-full !mt-4" appearance="outline">
      <mat-label>Email</mat-label>
      <input id="email" type="email" formControlName="email" matInput />
      <mat-error *ngIf="
          changePasswordForm.get('email')?.hasError('required')
        ">
        Email is required
      </mat-error>
    </mat-form-field>

    <mat-form-field class="w-full" appearance="outline">
      <mat-label>Current Password</mat-label>
      <input id="currentPassword" [type]="hideCurrentPassword ? 'password' : 'text'" formControlName="currentPassword"
        matInput />
      <button mat-icon-button matSuffix (click)="toggleVisibility('currentPassword')" type="button"
        class="password-toggle">
        <mat-icon>{{
          hideCurrentPassword ? "visibility_off" : "visibility"
          }}</mat-icon>
      </button>
      <mat-error *ngIf="changePasswordForm.get('currentPassword')?.hasError('required')">
        Current password is required
      </mat-error>
    </mat-form-field>

    <mat-form-field class="w-full" appearance="outline">
      <mat-label>New Password</mat-label>
      <input id="newPassword" [type]="hideNewPassword ? 'password' : 'text'" formControlName="newPassword" matInput />
      <button mat-icon-button matSuffix (click)="toggleVisibility('newPassword')" type="button" class="password-toggle">
        <mat-icon>{{
          hideNewPassword ? "visibility_off" : "visibility"
          }}</mat-icon>
      </button>
      <mat-error *ngIf="changePasswordForm.get('newPassword')?.hasError('required')">
        New password is required
      </mat-error>
      <mat-error *ngIf="changePasswordForm.get('newPassword')?.hasError('minlength')">
        New password must be at least 6 characters long
      </mat-error>

      <mat-error *ngIf="changePasswordForm.get('newPassword')?.hasError('samePassword')">
        New password cannot be the same as the current password
      </mat-error>
    </mat-form-field>

    <mat-form-field class="w-full" appearance="outline">
      <mat-label>Confirm New Password</mat-label>
      <input id="confirmNewPassword" [type]="hideConfirmNewPassword ? 'password' : 'text'"
        formControlName="confirmNewPassword" matInput />
      <button mat-icon-button matSuffix (click)="toggleVisibility('confirmNewPassword')" type="button"
        class="password-toggle">
        <mat-icon>{{
          hideConfirmNewPassword ? "visibility_off" : "visibility"
          }}</mat-icon>
      </button>
      <mat-error *ngIf="changePasswordForm.get('confirmNewPassword')?.hasError('required')">
        Confirm new password is required
      </mat-error>
      <mat-error *ngIf="changePasswordForm.get('confirmNewPassword')?.hasError('passwordMismatch')">
        Passwords do not match
      </mat-error>
    </mat-form-field>
  </form>
</div>

<div mat-dialog-actions class="flex justify-end gap-4 mt-8">
  <button mat-stroked-button color="warn" (click)="cancel()">Cancel</button>
  <button mat-flat-button color="primary" (click)="changePassword()" [disabled]="!changePasswordForm.valid">Change
    Password</button>
</div>