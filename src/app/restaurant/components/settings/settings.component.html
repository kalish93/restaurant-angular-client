<div class="min-h-screen bg-gray-50/50 p-4 sm:p-6 lg:p-8">
  <div class="mx-auto max-w-7xl">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-2xl font-bold tracking-tight text-gray-900 sm:text-3xl">Settings</h1>
      <p class="mt-2 text-sm text-gray-600">Manage your restaurant configuration and preferences</p>
    </div>

    <!-- Settings Tabs -->
    <div class="mb-8">
      <nav class="flex flex-wrap space-x-4 sm:space-x-8" aria-label="Tabs">
        <button *ngFor="let tab of tabs" (click)="activeTab = tab.id" [class]="activeTab === tab.id
            ? 'border-primary-500 text-primary-600'
            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
          class="whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm transition-colors">
          {{ tab.name }}
        </button>
      </nav>
    </div>

    <!-- Profile Settings Tab -->
    <div *ngIf="activeTab === 'profile'" class="space-y-6">
      <!-- Profile Information Card -->
      <div class="bg-white shadow rounded-lg">
        <div class="px-6 py-4 border-b border-gray-200">
          <h6 class=" font-medium text-gray-900">Profile Information</h6>
          <p class="mt-1 text-sm text-gray-500">Update your restaurant's basic information</p>
        </div>
        <div class="px-6 py-4">
          <form [formGroup]="profileForm" (ngSubmit)="onProfileSubmit()" class="space-y-6">
            <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
              <div>
                <label for="restaurantName" class="block text-sm font-medium text-gray-700">Restaurant Name</label>
                <input type="text" id="restaurantName" formControlName="name"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
                  [class.border-red-500]="profileForm.get('name')?.invalid && profileForm.get('name')?.touched">
                <div *ngIf="profileForm.get('name')?.invalid && profileForm.get('name')?.touched"
                  class="mt-1 text-sm text-red-600">
                  <span *ngIf="profileForm.get('name')?.errors?.['required']">Restaurant name is required</span>
                  <span *ngIf="profileForm.get('name')?.errors?.['minlength']">Restaurant name must be at least 2
                    characters</span>
                </div>
              </div>

              <div>
                <label for="phone" class="block text-sm font-medium text-gray-700">Phone Number</label>
                <input type="tel" id="phone" formControlName="phone"
                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
                  [class.border-red-500]="profileForm.get('phone')?.invalid && profileForm.get('phone')?.touched">
                <div *ngIf="profileForm.get('phone')?.invalid && profileForm.get('phone')?.touched"
                  class="mt-1 text-sm text-red-600">
                  <span *ngIf="profileForm.get('phone')?.errors?.['required']">Phone number is required</span>
                  <span *ngIf="profileForm.get('phone')?.errors?.['pattern']">Please enter a valid phone number</span>
                </div>
              </div>
            </div>

            <div>
              <label for="address" class="block text-sm font-medium text-gray-700">Address</label>
              <textarea id="address" rows="3" formControlName="address"
                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
                [class.border-red-500]="profileForm.get('address')?.invalid && profileForm.get('address')?.touched"></textarea>
              <div *ngIf="profileForm.get('address')?.invalid && profileForm.get('address')?.touched"
                class="mt-1 text-sm text-red-600">
                <span *ngIf="profileForm.get('address')?.errors?.['required']">Address is required</span>
                <span *ngIf="profileForm.get('address')?.errors?.['minlength']">Address must be at least 10
                  characters</span>
              </div>
            </div>

            <div class="flex justify-end">
              <button type="submit" [disabled]="!profileForm.valid || profileForm.pristine || isProfileLoading"
                class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed">
                <svg *ngIf="isProfileLoading" class="animate-spin -ml-1 mr-3 h-4 w-4 text-white"
                  xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                  </path>
                </svg>
                {{ isProfileLoading ? 'Saving...' : 'Save Profile' }}
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Restaurant Logo Card -->
      <div class="bg-white shadow rounded-lg">
        <div class="px-6 py-4 border-b border-gray-200">
          <h6 class=" font-medium text-gray-900">Restaurant Logo</h6>
          <p class="mt-1 text-sm text-gray-500">Upload or update your restaurant logo</p>
        </div>
        <div class="px-6 py-4">
          <div class="flex items-center space-x-6">
            <div class="flex-shrink-0">
              <img [src]="logoPreview || apiUrl + '/' + restaurant?.logo || 'assets/logo.jpeg'"
                alt="Restaurant Logo" class="h-20 w-20 rounded-lg object-cover border-2 border-gray-200">
            </div>
            <div class="flex-1">
              <div class="flex items-center space-x-4">
                <label for="logo-upload"
                  class="cursor-pointer inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                  <svg class="mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                  </svg>
                  Upload Logo
                </label>
                <button *ngIf="selectedFile" (click)="uploadLogo()"
                  class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                  Save Logo
                </button>
                <input id="logo-upload" type="file" accept="image/*" (change)="onLogoChange($event)" class="hidden">
                <button *ngIf="logoPreview" (click)="removeLogo()"
                  class="inline-flex items-center px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                  Remove
                </button>
              </div>
              <p class="mt-2 text-xs text-gray-500">PNG, JPG, GIF up to 2MB</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Appearance Settings Tab -->
    <div *ngIf="activeTab === 'appearance'" class="space-y-6">
      <!-- Color Palette Card -->
      <div class="bg-white shadow rounded-lg">
        <div class="px-6 py-4 border-b border-gray-200">
          <h6 class=" font-medium text-gray-900">Color Palette</h6>
          <p class="mt-1 text-sm text-gray-500">Customize your restaurant's color scheme</p>
        </div>
        <div class="px-6 py-4">
          <form [formGroup]="appearanceForm" (ngSubmit)="onAppearanceSubmit()" class="space-y-6">
            <!-- Preset Color Palettes -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-3">Choose from Preset Palettes</label>
              <div class="grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
                <div *ngFor="let palette of presetPalettes" (click)="selectPresetPalette(palette)"
                  [class]="selectedPalette?.id === palette.id ? 'ring-2 ring-primary-500' : 'ring-1 ring-gray-200'"
                  class="relative cursor-pointer rounded-lg p-3 hover:ring-2 hover:ring-primary-300 transition-all">
                  <div class="flex space-x-1 mb-2">
                    <div *ngFor="let color of palette.colors" [style.background-color]="color"
                      class="w-6 h-6 rounded border border-gray-200"></div>
                  </div>
                  <p class="text-xs font-medium text-gray-900">{{ palette.name }}</p>
                </div>
              </div>
            </div>

            <!-- Custom Color Picker -->
            <div class="border-t pt-6">
              <label class="block text-sm font-medium text-gray-700 mb-3">Custom Colors</label>
              <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Primary Color</label>
                  <div class="flex items-center space-x-3">
                    <input type="color" formControlName="primaryColor"
                      class="h-10 w-16 rounded border border-gray-300 cursor-pointer">
                    <input type="text" formControlName="primaryColor"
                      class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
                      placeholder="#3B82F6">
                  </div>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Secondary Color</label>
                  <div class="flex items-center space-x-3">
                    <input type="color" formControlName="secondaryColor"
                      class="h-10 w-16 rounded border border-gray-300 cursor-pointer">
                    <input type="text" formControlName="secondaryColor"
                      class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
                      placeholder="#10B981">
                  </div>
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Accent Color</label>
                  <div class="flex items-center space-x-3">
                    <input type="color" formControlName="accentColor"
                      class="h-10 w-16 rounded border border-gray-300 cursor-pointer">
                    <input type="text" formControlName="accentColor"
                      class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
                      placeholder="#F59E0B">
                  </div>
                </div>
              </div>
            </div>

            <!-- Color Preview -->
            <div class="border-t pt-6">
              <label class="block text-sm font-medium text-gray-700 mb-3">Preview</label>
              <div class="bg-gray-50 rounded-lg p-4">
                <div class="flex items-center space-x-4">
                  <button [style.background-color]="appearanceForm.get('primaryColor')?.value"
                    class="px-4 py-2 rounded-md text-white font-medium hover:opacity-90 transition-opacity">
                    Primary Button
                  </button>
                  <button [style.background-color]="appearanceForm.get('secondaryColor')?.value"
                    class="px-4 py-2 rounded-md text-white font-medium hover:opacity-90 transition-opacity">
                    Secondary Button
                  </button>
                  <div [style.background-color]="appearanceForm.get('accentColor')?.value"
                    class="w-8 h-8 rounded-full border border-gray-200"></div>
                </div>
                <div class="mt-4 text-sm text-gray-600">
                  <p>These colors will be applied throughout your restaurant's interface.</p>
                </div>
              </div>
            </div>

            <div class="flex justify-end">
              <button type="submit" [disabled]="!appearanceForm.valid"
                class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed">
                Save Appearance
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Business Settings Tab -->
    <div *ngIf="activeTab === 'business'" class="space-y-6">
      <!-- Restaurant Status Card -->
      <div class="bg-white shadow rounded-lg">
        <div class="px-6 py-4 border-b border-gray-200">
          <h6 class=" font-medium text-gray-900">Restaurant Status</h6>
          <p class="mt-1 text-sm text-gray-500">Control your restaurant's availability</p>
        </div>
        <div class="px-6 py-4">
          <div class="flex items-center justify-between">
            <div>
              <h6 class="text-base font-medium text-gray-900">Open/Closed Status</h6>
              <p class="text-sm text-gray-500">Set whether your restaurant is currently accepting orders</p>
            </div>
            <div class="flex items-center space-x-2">
              <mat-slide-toggle formControlName="restaurantStatus" color="primary" (change)="onOpenOrClose()"
                [checked]="restaurant?.isOpen" class="scale-90">
              </mat-slide-toggle>
              <span class="text-sm font-medium"
                [class]="settingsForm.get('restaurantStatus')?.value ? 'text-green-600' : 'text-red-600'">
                {{ settingsForm.get("restaurantStatus")?.value ? "Open" : "Closed" }}
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- Tax Rate Card -->
      <div class="bg-white shadow rounded-lg">
        <div class="px-6 py-4 border-b border-gray-200">
          <h6 class=" font-medium text-gray-900">Tax Configuration</h6>
          <p class="mt-1 text-sm text-gray-500">Set your restaurant's tax rate</p>
        </div>
        <div class="px-6 py-4">
          <form [formGroup]="settingsForm" (ngSubmit)="onSubmit()" class="space-y-4">
            <div>
              <label for="taxRate" class="block text-sm font-medium text-gray-700">Tax Rate (%)</label>
              <mat-form-field appearance="outline" class="w-32">
                <input matInput type="number" id="taxRate" formControlName="taxRate" step="0.01" min="0" max="100">
              </mat-form-field>
            </div>
            <div class="flex justify-end">
              <button type="submit" [disabled]="!settingsForm.get('taxRate')?.valid"
                class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed">
                Save Tax Rate
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
